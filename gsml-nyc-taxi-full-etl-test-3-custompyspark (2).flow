{
  "metadata": {
    "version": 1,
    "disable_limits": false,
    "instance_type": "ml.m5.24xlarge"
  },
  "parameters": [],
  "nodes": [
    {
      "node_id": "5951cb67-cbd2-4086-bb96-d91c57f3e4bf",
      "type": "SOURCE",
      "operator": "sagemaker.s3_source_0.1",
      "parameters": {
        "dataset_definition": {
          "__typename": "S3CreateDatasetDefinitionOutput",
          "datasetSourceType": "S3",
          "name": "ride-info",
          "description": null,
          "s3ExecutionContext": {
            "__typename": "S3ExecutionContext",
            "s3Uri": "s3://dsoaws/nyc-taxi-orig-cleaned-split-parquet-per-year/ride-info/",
            "s3ContentType": "parquet",
            "s3HasHeader": true,
            "s3FieldDelimiter": ",",
            "s3DirIncludesNested": true,
            "s3AddsFilenameColumn": false,
            "s3RoleArn": null
          }
        }
      },
      "inputs": [],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "0a9ddffe-0929-4a2a-b5cc-415af143d3fc",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.infer_and_cast_type_0.1",
      "parameters": {},
      "trained_parameters": {},
      "inputs": [
        {
          "name": "df",
          "node_id": "5951cb67-cbd2-4086-bb96-d91c57f3e4bf",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "3b15f762-96d8-4099-af53-6f10a8d047a0",
      "type": "SOURCE",
      "operator": "sagemaker.s3_source_0.1",
      "parameters": {
        "dataset_definition": {
          "__typename": "S3CreateDatasetDefinitionOutput",
          "datasetSourceType": "S3",
          "name": "ride-fare",
          "description": null,
          "s3ExecutionContext": {
            "__typename": "S3ExecutionContext",
            "s3Uri": "s3://dsoaws/nyc-taxi-orig-cleaned-split-parquet-per-year/ride-fare/",
            "s3ContentType": "parquet",
            "s3HasHeader": true,
            "s3FieldDelimiter": ",",
            "s3DirIncludesNested": true,
            "s3AddsFilenameColumn": false,
            "s3RoleArn": null
          }
        }
      },
      "inputs": [],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "9f7e48eb-ae27-4e2e-8eb0-63bebd611e4d",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.infer_and_cast_type_0.1",
      "parameters": {},
      "trained_parameters": {},
      "inputs": [
        {
          "name": "df",
          "node_id": "3b15f762-96d8-4099-af53-6f10a8d047a0",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "12945feb-5dc7-40a8-884f-93a6765dbdef",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.join_tables_0.1",
      "parameters": {
        "left_column": "ride_id",
        "right_column": "ride_id",
        "join_type": "inner"
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "0a9ddffe-0929-4a2a-b5cc-415af143d3fc",
          "output_name": "default"
        },
        {
          "name": "df",
          "node_id": "9f7e48eb-ae27-4e2e-8eb0-63bebd611e4d",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "ef08d46f-1b5f-4389-ac52-cdbfc14c9b06",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.manage_columns_0.1",
      "parameters": {
        "operator": "Drop column",
        "drop_column_parameters": {
          "column_to_drop": [
            "dropoff_at",
            "pickup_at",
            "ride_id_1",
            "vendor_id",
            "store_and_fwd_flag"
          ]
        }
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "12945feb-5dc7-40a8-884f-93a6765dbdef",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "b8854a9a-d389-4198-8903-c872c06617ff",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.manage_columns_0.1",
      "parameters": {
        "operator": "Move column",
        "move_column_parameters": {
          "move_type": "Move to start",
          "move_to_start_parameters": {
            "column_to_move": "total_amount"
          }
        },
        "drop_column_parameters": {}
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "ef08d46f-1b5f-4389-ac52-cdbfc14c9b06",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "84361f90-f7c3-46e6-85de-5c8f6bb5471e",
      "type": "DESTINATION",
      "operator": "sagemaker.spark.s3_destination_0.1",
      "name": "S3: nyc-taxi-joined-full",
      "parameters": {
        "output_config": {
          "compression": "none",
          "output_path": "s3://sagemaker-us-east-1-795321850195/gsml-nyc-taxi-full-etl-ml-export-to-s3-via-notebook-test-1/",
          "output_content_type": "PARQUET"
        }
      },
      "inputs": [
        {
          "name": "default",
          "node_id": "b8854a9a-d389-4198-8903-c872c06617ff",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "842a9df0-a299-4625-8f8a-ffca58929650",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.custom_code_0.1",
      "parameters": {
        "operator": "Python (PySpark)",
        "pyspark_parameters": {
          "code": "# Table is available as variable `df`\ndf_train, _ = df.randomSplit([0.70, 0.30], seed=0)"
        },
        "name": "train"
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "b8854a9a-d389-4198-8903-c872c06617ff",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "052787ea-75d7-4079-be2a-3d436a45b0c8",
      "type": "TRANSFORM",
      "operator": "sagemaker.spark.custom_code_0.1",
      "parameters": {
        "operator": "Python (PySpark)",
        "pyspark_parameters": {
          "code": "# Table is available as variable `df`\n_, df_validation = df.randomSplit([0.70, 0.30], seed=0)"
        },
        "name": "validation"
      },
      "inputs": [
        {
          "name": "df",
          "node_id": "b8854a9a-d389-4198-8903-c872c06617ff",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "5b3612c9-3984-4ae7-bb30-192d7eecc3c2",
      "type": "DESTINATION",
      "operator": "sagemaker.spark.s3_destination_0.1",
      "name": "S3: nyc-taxi-full-joined-drop-training",
      "parameters": {
        "output_config": {
          "compression": "none",
          "output_path": "s3://sagemaker-us-east-1-795321850195/gsml-nyc-taxi-full-etl-test-3/training/",
          "output_content_type": "PARQUET"
        }
      },
      "inputs": [
        {
          "name": "default",
          "node_id": "842a9df0-a299-4625-8f8a-ffca58929650",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    },
    {
      "node_id": "4ada4e18-af16-4522-a050-824cd9930285",
      "type": "DESTINATION",
      "operator": "sagemaker.spark.s3_destination_0.1",
      "name": "S3: nyc-taxi-full-joined-drop-validation",
      "parameters": {
        "output_config": {
          "compression": "none",
          "output_path": "s3://sagemaker-us-east-1-795321850195/gsml-nyc-taxi-full-etl-test-3/validation/",
          "output_content_type": "PARQUET"
        }
      },
      "inputs": [
        {
          "name": "default",
          "node_id": "052787ea-75d7-4079-be2a-3d436a45b0c8",
          "output_name": "default"
        }
      ],
      "outputs": [
        {
          "name": "default"
        }
      ]
    }
  ]
}